<?php
header("Content-type: application/octet-stream");
header("Content-Disposition: attachment; filename=Summary-Inspek-Langganan-".$_GET['buyer']."-".substr($_GET['awal'],0,10).".xls");//ganti nama sesuai keperluan
header("Pragma: no-cache");
header("Expires: 0");
//disini script laporan anda
?>
<?php
ini_set("error_reporting", 1);
session_start();
//error_reporting(E_ALL ^ (E_NOTICE | E_WARNING));
include "../../koneksi.php";
include "../../tgl_indo.php";
//--
$idkk=$_REQUEST['idkk'];
$act=$_GET['g'];
//-
$Awal=$_GET['awal'];
$Akhir=$_GET['akhir'];
$Buyer=$_GET['buyer'];
$qTgl=mysqli_query($con,"SELECT DATE_FORMAT(now(),'%Y-%m-%d') as tgl_skrg,DATE_FORMAT(now(),'%H:%i:%s') as jam_skrg");
$rTgl=mysqli_fetch_array($qTgl);
if($Awal!=""){$tgl=substr($Awal,0,10); $jam=$Awal;}else{$tgl=$rTgl['tgl_skrg']; $jam=$rTgl['jam_skrg'];}
?>
<?php 
$nmBln=array(1 => "JANUARI","FEBUARI","MARET","APRIL","MEI","JUNI","JULI","AGUSTUS","SEPTEMBER","OKTOBER","NOVEMBER","DESEMBER");	
?>
<body>
<table width="100%" border='1'>
  <tr>
    <th colspan="42" align="center">SUMMARY INSPEKSI LANGGANAN</th>
  </tr>
  <tr>
    <th colspan="42" align="center">TANGGAL: <?php echo date("d/m/Y", strtotime($Awal));?> S/D <?php echo date("d/m/Y", strtotime($Akhir));?></th>
  </tr>
  <tr>
    <th colspan="42" align="center">BUYER: <?php echo $Buyer;?></th>
  </tr>
  <thead>
    <tr align="center">
      <td><font size="-2"><strong>UOM</strong></font></td>
      <td><font size="-2"><strong>LANGGANAN</strong></font></td>
      <td><font size="-2"><strong>ROLL</strong></font></td>
      <td><font size="-2"><strong>QTY</strong></font></td>
      <td><font size="-2"><strong>YARD</strong></font></td>
      <td><font size="-2"><strong>A Slub</strong></font></td>
      <td><font size="-2"><strong>A Barre</strong></font></td>
      <td><font size="-2"><strong>A Uneven</strong></font></td>
      <td><font size="-2"><strong>A YarnContam</strong></font></td>
      <td><font size="-2"><strong>A Neps</strong></font></td>
      <td><font size="-2"><strong>B Missing</strong></font></td>
      <td><font size="-2"><strong>B Holes</strong></font></td>
      <td><font size="-2"><strong>B Streak</strong></font></td>
      <td><font size="-2"><strong>B MissKnit</strong></font></td>
      <td><font size="-2"><strong>B Knot</strong></font></td>
      <td><font size="-2"><strong>B Oil</strong></font></td>
      <td><font size="-2"><strong>B Fly</strong></font></td>
      <td><font size="-2"><strong>C Hair</strong></font></td>
      <td><font size="-2"><strong>C Holes</strong></font></td>
      <td><font size="-2"><strong>C Color</strong></font></td>
      <td><font size="-2"><strong>C Abra</strong></font></td>
      <td><font size="-2"><strong>C Dye</strong></font></td>
      <td><font size="-2"><strong>C Wrink</strong></font></td>
      <td><font size="-2"><strong>C Bowing</strong></font></td>
      <td><font size="-2"><strong>C Pin</strong></font></td>
      <td><font size="-2"><strong>C Pick</strong></font></td>
      <td><font size="-2"><strong>C Knot</strong></font></td>
      <td><font size="-2"><strong>D Uneven</strong></font></td>
      <td><font size="-2"><strong>D Stains</strong></font></td>
      <td><font size="-2"><strong>D Oil</strong></font></td>
      <td><font size="-2"><strong>D Dirt</strong></font></td>
      <td><font size="-2"><strong>D Water</strong></font></td>
      <td><font size="-2"><strong>E Print</strong></font></td>
      <td><font size="-2"><strong>Total Point</strong></font></td>
      <td><font size="-2"><strong>Jml A</strong></font></td>
      <td><font size="-2"><strong>Kg A</strong></font></td>
      <td><font size="-2"><strong>Yd A</strong></font></td>
      <td><font size="-2"><strong>Jml B</strong></font></td>
      <td><font size="-2"><strong>Kg B</strong></font></td>
      <td><font size="-2"><strong>Yd B</strong></font></td>
      <td><font size="-2"><strong>Jml C/X</strong></font></td>
      <td><font size="-2"><strong>Kg C/X</strong></font></td>
      <td><font size="-2"><strong>Yd C/X</strong></font></td>
    </tr>
  </thead>
	<tbody>  
		<?php
	$no=1;
  if($Awal!=""){
    $sql="SELECT
      D.LEGALNAME1 AS LANGGANAN,
      D.LONGDESCRIPTION AS BUYER,
      SUM(C.POINTS) AS TOTAL_POIN,
      SUM(B.LENGTHGROSS) AS TOTAL_YARD,
      SUM(B.WEIGHTGROSS) AS TOTAL_QTY
      FROM PRODUCTIONDEMAND A 
      LEFT JOIN ELEMENTSINSPECTION B
      ON A.CODE = B.DEMANDCODE 
      LEFT JOIN 
      ELEMENTSINSPECTIONEVENT C 
      ON B.ELEMENTCODE = C.ELEMENTSINSPECTIONELEMENTCODE 
      LEFT JOIN
        (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
        SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
        SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
        FROM SALESORDER SALESORDER
        LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
        LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
        LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
        LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
        LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
        SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
        SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
        SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
        SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
        GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
        SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) D 
      ON A.PROJECTCODE = D.CODE AND A.ORIGDLVSALORDERLINEORDERLINE = D.ORDERLINE
      WHERE LENGTH(TRIM(B.ELEMENTCODE))=11 AND VARCHAR_FORMAT (B.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
      AND D.LONGDESCRIPTION = '$Buyer'
      GROUP BY 
        D.LEGALNAME1,
        D.LONGDESCRIPTION";
        $stmt=db2_exec($conn1,$sql, array('cursor'=>DB2_SCROLLABLE));
    }else{}
			while($row1=db2_fetch_assoc($stmt)){
        $totalpoin = explode(".",$row1['TOTAL_POIN']);
        //Query Total Roll & Lebar Inspek
        $sqlr="SELECT 
          COUNT(B.DEMANDCODE) AS TOTAL_ROLL
          FROM PRODUCTIONDEMAND A 
          LEFT JOIN ELEMENTSINSPECTION B
          ON A.CODE = B.DEMANDCODE
          LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
          SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
          SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
          FROM SALESORDER SALESORDER
          LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
          LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
          LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
          LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
          LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
          SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
          SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
          SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
          SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
          GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
          SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) D 
        ON A.PROJECTCODE = D.CODE AND A.ORIGDLVSALORDERLINEORDERLINE = D.ORDERLINE
        WHERE LENGTH(TRIM(B.ELEMENTCODE))=11 AND VARCHAR_FORMAT (B.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND D.LONGDESCRIPTION = '$row1[BUYER]' AND D.LEGALNAME1='$row1[LANGGANAN]'";
        $stmt1=db2_exec($conn1,$sqlr, array('cursor'=>DB2_SCROLLABLE));
        $rr = db2_fetch_assoc($stmt1);

        //QUERY DEFECT Y 
        $sqlY="SELECT 
            Z.LEGALNAME1 AS LANGGANAN, Z.LONGDESCRIPTION AS BUYER, A.POINTS_Y01, B.POINTS_Y02, C.POINTS_Y03, D.POINTS_Y04, E.POINTS_Y05 
          FROM PRODUCTIONDEMAND X 
          LEFT JOIN ELEMENTSINSPECTION Y
          ON X.CODE = Y.DEMANDCODE
          LEFT JOIN
            (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
              SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
              SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
              FROM SALESORDER SALESORDER
              LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
              LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
              LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
              LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
              LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
              SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
              SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
              SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
              SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
              GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
              SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) Z
          ON X.PROJECTCODE = Z.CODE AND X.ORIGDLVSALORDERLINEORDERLINE = Z.ORDERLINE
          LEFT JOIN
          (SELECT
            SALES.LEGALNAME1 AS LANGGANAN,
            SALES.LONGDESCRIPTION AS BUYER,
            SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_Y01
          FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
          LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
          ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
          LEFT JOIN 
            ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
          ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
          LEFT JOIN
            (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
              SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
              SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
              FROM SALESORDER SALESORDER
              LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
              LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
              LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
              LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
              LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
              SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
              SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
              SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
              SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
              GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
              SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
          ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
          WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
          AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'Y01'
          GROUP BY 
          SALES.LEGALNAME1,
          SALES.LONGDESCRIPTION) A
          ON Z.LEGALNAME1 = A.LANGGANAN AND Z.LONGDESCRIPTION = A.BUYER
          LEFT JOIN
          (SELECT
            SALES.LEGALNAME1 AS LANGGANAN,
            SALES.LONGDESCRIPTION AS BUYER,
            SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_Y02
          FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
          LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
          ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
          LEFT JOIN 
            ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
          ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
          LEFT JOIN
            (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
              SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
              SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
              FROM SALESORDER SALESORDER
              LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
              LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
              LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
              LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
              LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
              SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
              SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
              SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
              SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
              GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
              SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
          ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
          WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
          AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'Y02'
          GROUP BY 
          SALES.LEGALNAME1,
          SALES.LONGDESCRIPTION) B
          ON Z.LEGALNAME1 = B.LANGGANAN AND Z.LONGDESCRIPTION = B.BUYER
          LEFT JOIN
          (SELECT
            SALES.LEGALNAME1 AS LANGGANAN,
            SALES.LONGDESCRIPTION AS BUYER,
            SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_Y03
          FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
          LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
          ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
          LEFT JOIN 
            ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
          ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
          LEFT JOIN
            (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
              SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
              SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
              FROM SALESORDER SALESORDER
              LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
              LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
              LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
              LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
              LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
              SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
              SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
              SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
              SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
              GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
              SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
          ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
          WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
          AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'Y03'
          GROUP BY 
          SALES.LEGALNAME1,
          SALES.LONGDESCRIPTION) C
          ON Z.LEGALNAME1 = C.LANGGANAN AND Z.LONGDESCRIPTION = C.BUYER
          LEFT JOIN
          (SELECT
            SALES.LEGALNAME1 AS LANGGANAN,
            SALES.LONGDESCRIPTION AS BUYER,
            SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_Y04
          FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
          LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
          ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
          LEFT JOIN 
            ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
          ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
          LEFT JOIN
            (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
              SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
              SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
              FROM SALESORDER SALESORDER
              LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
              LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
              LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
              LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
              LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
              SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
              SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
              SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
              SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
              GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
              SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
          ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
          WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
          AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'Y04'
          GROUP BY 
          SALES.LEGALNAME1,
          SALES.LONGDESCRIPTION) D
          ON Z.LEGALNAME1 = D.LANGGANAN AND Z.LONGDESCRIPTION = D.BUYER
          LEFT JOIN
          (SELECT
            SALES.LEGALNAME1 AS LANGGANAN,
            SALES.LONGDESCRIPTION AS BUYER,
            SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_Y05
          FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
          LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
          ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
          LEFT JOIN 
            ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
          ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
          LEFT JOIN
            (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
              SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
              SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
              FROM SALESORDER SALESORDER
              LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
              LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
              LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
              LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
              LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
              SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
              SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
              SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
              SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
              GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
              SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
          ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
          WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
          AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'Y05'
          GROUP BY 
          SALES.LEGALNAME1,
          SALES.LONGDESCRIPTION) E
          ON Z.LEGALNAME1 = E.LANGGANAN AND Z.LONGDESCRIPTION = E.BUYER
          WHERE Z.LONGDESCRIPTION = '$row1[BUYER]' AND Z.LEGALNAME1='$row1[LANGGANAN]'
          GROUP BY 
          Z.LEGALNAME1, Z.LONGDESCRIPTION, A.POINTS_Y01, B.POINTS_Y02, C.POINTS_Y03, D.POINTS_Y04, E.POINTS_Y05";
      $stmt2=db2_exec($conn1,$sqlY, array('cursor'=>DB2_SCROLLABLE));
      $rY = db2_fetch_assoc($stmt2);
      $ASLUB = explode(".",$rY['POINTS_Y01']);
      $ABARRE = explode(".",$rY['POINTS_Y02']);
      $AUNEVEN = explode(".",$rY['POINTS_Y03']);
      $AYARN = explode(".",$rY['POINTS_Y04']);
      $ANEPS = explode(".",$rY['POINTS_Y05']);

      //QUERY DEFECT T
      $sqlT="SELECT 
          Z.LEGALNAME1 AS LANGGANAN, Z.LONGDESCRIPTION AS BUYER, A.POINTS_T01, B.POINTS_T02, C.POINTS_T03, D.POINTS_T04, E.POINTS_T05, F.POINTS_T06, G.POINTS_T07 
        FROM PRODUCTIONDEMAND X 
        LEFT JOIN ELEMENTSINSPECTION Y
        ON X.CODE = Y.DEMANDCODE
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) Z
        ON X.PROJECTCODE = Z.CODE AND X.ORIGDLVSALORDERLINEORDERLINE = Z.ORDERLINE
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_T01
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'T01'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) A
        ON Z.LEGALNAME1 = A.LANGGANAN AND Z.LONGDESCRIPTION = A.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_T02
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'T02'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) B
        ON Z.LEGALNAME1 = B.LANGGANAN AND Z.LONGDESCRIPTION = B.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_T03
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'T03'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) C
        ON Z.LEGALNAME1 = C.LANGGANAN AND Z.LONGDESCRIPTION = C.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_T04
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'T04'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) D
        ON Z.LEGALNAME1 = D.LANGGANAN AND Z.LONGDESCRIPTION = D.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_T05
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'T05'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) E
        ON Z.LEGALNAME1 = E.LANGGANAN AND Z.LONGDESCRIPTION = E.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_T06
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'T06'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) F
        ON Z.LEGALNAME1 = F.LANGGANAN AND Z.LONGDESCRIPTION = F.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_T07
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'T07'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) G
        ON Z.LEGALNAME1 = G.LANGGANAN AND Z.LONGDESCRIPTION = G.BUYER
        WHERE Z.LONGDESCRIPTION = '$row1[BUYER]' AND Z.LEGALNAME1='$row1[LANGGANAN]'
        GROUP BY 
        Z.LEGALNAME1, Z.LONGDESCRIPTION, A.POINTS_T01, B.POINTS_T02, C.POINTS_T03, D.POINTS_T04, E.POINTS_T05, F.POINTS_T06, G.POINTS_T07";
      $stmt3=db2_exec($conn1,$sqlT, array('cursor'=>DB2_SCROLLABLE));
      $rT = db2_fetch_assoc($stmt3);
      $BMISSING = explode(".",$rT['POINTS_T01']);
      $BHOLES = explode(".",$rT['POINTS_T02']);
      $BSTREAK = explode(".",$rT['POINTS_T03']);
      $BMISSKNIT = explode(".",$rT['POINTS_T04']);
      $BKNOT = explode(".",$rT['POINTS_T05']);
      $BOIL = explode(".",$rT['POINTS_T06']);
      $BFLY = explode(".",$rT['POINTS_T07']);

      //QUERY DEFECT D
      $sqlD="SELECT 
          Z.LEGALNAME1 AS LANGGANAN, Z.LONGDESCRIPTION AS BUYER, A.POINTS_D01, B.POINTS_D02, C.POINTS_D03, D.POINTS_D04, E.POINTS_D05, F.POINTS_D06, G.POINTS_D07, H.POINTS_D08, I.POINTS_D09, J.POINTS_D10  
        FROM PRODUCTIONDEMAND X 
        LEFT JOIN ELEMENTSINSPECTION Y
        ON X.CODE = Y.DEMANDCODE
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) Z
        ON X.PROJECTCODE = Z.CODE AND X.ORIGDLVSALORDERLINEORDERLINE = Z.ORDERLINE
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_D01
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'D01'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) A
        ON Z.LEGALNAME1 = A.LANGGANAN AND Z.LONGDESCRIPTION = A.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_D02
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'D02'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) B
        ON Z.LEGALNAME1 = B.LANGGANAN AND Z.LONGDESCRIPTION = B.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_D03
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'D03'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) C
        ON Z.LEGALNAME1 = C.LANGGANAN AND Z.LONGDESCRIPTION = C.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_D04
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'D04'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) D
        ON Z.LEGALNAME1 = D.LANGGANAN AND Z.LONGDESCRIPTION = D.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_D05
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'D05'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) E
        ON Z.LEGALNAME1 = E.LANGGANAN AND Z.LONGDESCRIPTION = E.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_D06
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'D06'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) F
        ON Z.LEGALNAME1 = F.LANGGANAN AND Z.LONGDESCRIPTION = F.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_D07
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'D07'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) G
        ON Z.LEGALNAME1 = G.LANGGANAN AND Z.LONGDESCRIPTION = G.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_D08
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'D08'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) H
        ON Z.LEGALNAME1 = H.LANGGANAN AND Z.LONGDESCRIPTION = H.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_D09
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'D09'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) I
        ON Z.LEGALNAME1 = I.LANGGANAN AND Z.LONGDESCRIPTION = I.BUYER
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_D10
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'D10'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) J
        ON Z.LEGALNAME1 = J.LANGGANAN AND Z.LONGDESCRIPTION = J.BUYER
        WHERE Z.LONGDESCRIPTION = '$row1[BUYER]' AND Z.LEGALNAME1='$row1[LANGGANAN]'
        GROUP BY 
        Z.LEGALNAME1, Z.LONGDESCRIPTION, A.POINTS_D01, B.POINTS_D02, C.POINTS_D03, D.POINTS_D04, E.POINTS_D05, F.POINTS_D06, G.POINTS_D07, H.POINTS_D08, I.POINTS_D09, J.POINTS_D10";
        $stmt4=db2_exec($conn1,$sqlD, array('cursor'=>DB2_SCROLLABLE));
        $rD = db2_fetch_assoc($stmt4);
        $CHAIR = explode(".",$rD['POINTS_D01']);
        $CHOLES = explode(".",$rD['POINTS_D02']);
        $CCOLOR = explode(".",$rD['POINTS_D03']);
        $CABRA = explode(".",$rD['POINTS_D04']);
        $CDYE = explode(".",$rD['POINTS_D05']);
        $CWRINK = explode(".",$rD['POINTS_D06']);
        $CBOWING = explode(".",$rD['POINTS_D07']);
        $CPIN = explode(".",$rD['POINTS_D08']);
        $CPICK = explode(".",$rD['POINTS_D09']);
        $CKNOT = explode(".",$rD['POINTS_D10']);

        //QUERY DEFECT C
        $sqlC="SELECT 
            Z.LEGALNAME1 AS LANGGANAN, Z.LONGDESCRIPTION AS BUYER, A.POINTS_C01, B.POINTS_C02, C.POINTS_C03, D.POINTS_C04, E.POINTS_C05 
          FROM PRODUCTIONDEMAND X 
          LEFT JOIN ELEMENTSINSPECTION Y
          ON X.CODE = Y.DEMANDCODE
          LEFT JOIN
            (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
              SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
              SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
              FROM SALESORDER SALESORDER
              LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
              LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
              LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
              LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
              LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
              SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
              SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
              SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
              SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
              GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
              SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) Z
          ON X.PROJECTCODE = Z.CODE AND X.ORIGDLVSALORDERLINEORDERLINE = Z.ORDERLINE
          LEFT JOIN
          (SELECT
            SALES.LEGALNAME1 AS LANGGANAN,
            SALES.LONGDESCRIPTION AS BUYER,
            SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_C01
          FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
          LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
          ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
          LEFT JOIN 
            ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
          ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
          LEFT JOIN
            (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
              SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
              SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
              FROM SALESORDER SALESORDER
              LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
              LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
              LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
              LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
              LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
              SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
              SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
              SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
              SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
              GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
              SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
          ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
          WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
          AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'C01'
          GROUP BY 
          SALES.LEGALNAME1,
          SALES.LONGDESCRIPTION) A
          ON Z.LEGALNAME1 = A.LANGGANAN AND Z.LONGDESCRIPTION = A.BUYER
          LEFT JOIN
          (SELECT
            SALES.LEGALNAME1 AS LANGGANAN,
            SALES.LONGDESCRIPTION AS BUYER,
            SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_C02
          FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
          LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
          ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
          LEFT JOIN 
            ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
          ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
          LEFT JOIN
            (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
              SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
              SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
              FROM SALESORDER SALESORDER
              LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
              LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
              LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
              LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
              LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
              SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
              SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
              SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
              SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
              GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
              SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
          ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
          WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
          AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'C02'
          GROUP BY 
          SALES.LEGALNAME1,
          SALES.LONGDESCRIPTION) B
          ON Z.LEGALNAME1 = B.LANGGANAN AND Z.LONGDESCRIPTION = B.BUYER
          LEFT JOIN
          (SELECT
            SALES.LEGALNAME1 AS LANGGANAN,
            SALES.LONGDESCRIPTION AS BUYER,
            SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_C03
          FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
          LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
          ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
          LEFT JOIN 
            ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
          ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
          LEFT JOIN
            (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
              SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
              SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
              FROM SALESORDER SALESORDER
              LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
              LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
              LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
              LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
              LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
              SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
              SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
              SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
              SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
              GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
              SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
          ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
          WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
          AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'C03'
          GROUP BY 
          SALES.LEGALNAME1,
          SALES.LONGDESCRIPTION) C
          ON Z.LEGALNAME1 = C.LANGGANAN AND Z.LONGDESCRIPTION = C.BUYER
          LEFT JOIN
          (SELECT
            SALES.LEGALNAME1 AS LANGGANAN,
            SALES.LONGDESCRIPTION AS BUYER,
            SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_C04
          FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
          LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
          ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
          LEFT JOIN 
            ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
          ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
          LEFT JOIN
            (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
              SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
              SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
              FROM SALESORDER SALESORDER
              LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
              LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
              LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
              LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
              LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
              SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
              SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
              SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
              SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
              GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
              SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
          ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
          WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
          AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'C04'
          GROUP BY 
          SALES.LEGALNAME1,
          SALES.LONGDESCRIPTION) D
          ON Z.LEGALNAME1 = D.LANGGANAN AND Z.LONGDESCRIPTION = D.BUYER
          LEFT JOIN
          (SELECT
            SALES.LEGALNAME1 AS LANGGANAN,
            SALES.LONGDESCRIPTION AS BUYER,
            SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_C05
          FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
          LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
          ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
          LEFT JOIN 
            ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
          ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
          LEFT JOIN
            (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
              SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
              SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
              FROM SALESORDER SALESORDER
              LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
              LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
              LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
              LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
              LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
              SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
              SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
              SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
              SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
              GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
              SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
          ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
          WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
          AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'C05'
          GROUP BY 
          SALES.LEGALNAME1,
          SALES.LONGDESCRIPTION) E
          ON Z.LEGALNAME1 = E.LANGGANAN AND Z.LONGDESCRIPTION = E.BUYER
          WHERE Z.LONGDESCRIPTION = '$row1[BUYER]' AND Z.LEGALNAME1='$row1[LANGGANAN]'
          GROUP BY 
          Z.LEGALNAME1, Z.LONGDESCRIPTION, A.POINTS_C01, B.POINTS_C02, C.POINTS_C03, D.POINTS_C04, E.POINTS_C05";
          $stmt5=db2_exec($conn1,$sqlC, array('cursor'=>DB2_SCROLLABLE));
          $rC = db2_fetch_assoc($stmt5);
          $DUNEVEN = explode(".",$rC['POINTS_C01']);
          $DSTAINS = explode(".",$rC['POINTS_C02']);
          $DOIL = explode(".",$rC['POINTS_C03']);
          $DDIRT = explode(".",$rC['POINTS_C04']);
          $DWATER = explode(".",$rC['POINTS_C05']);

      //QUERY DEFECT P 
      $sqlP="SELECT 
          Z.LEGALNAME1 AS LANGGANAN, Z.LONGDESCRIPTION AS BUYER, A.POINTS_P01 
        FROM PRODUCTIONDEMAND X 
        LEFT JOIN ELEMENTSINSPECTION Y
        ON X.CODE = Y.DEMANDCODE
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) Z
        ON X.PROJECTCODE = Z.CODE AND X.ORIGDLVSALORDERLINEORDERLINE = Z.ORDERLINE
        LEFT JOIN
        (SELECT
          SALES.LEGALNAME1 AS LANGGANAN,
          SALES.LONGDESCRIPTION AS BUYER,
          SUM(ELEMENTSINSPECTIONEVENT.POINTS) AS POINTS_P01
        FROM PRODUCTIONDEMAND PRODUCTIONDEMAND 
        LEFT JOIN ELEMENTSINSPECTION ELEMENTSINSPECTION
        ON PRODUCTIONDEMAND.CODE = ELEMENTSINSPECTION.DEMANDCODE 
        LEFT JOIN 
          ELEMENTSINSPECTIONEVENT ELEMENTSINSPECTIONEVENT 
        ON ELEMENTSINSPECTION.ELEMENTCODE = ELEMENTSINSPECTIONEVENT.ELEMENTSINSPECTIONELEMENTCODE 
        LEFT JOIN
          (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
            SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
            SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
            FROM SALESORDER SALESORDER
            LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
            LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
            LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
            LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
            LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
            SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
            SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
            SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
            SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
            GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
            SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) SALES 
        ON PRODUCTIONDEMAND.PROJECTCODE = SALES.CODE AND PRODUCTIONDEMAND.ORIGDLVSALORDERLINEORDERLINE = SALES.ORDERLINE
        WHERE LENGTH(TRIM(ELEMENTSINSPECTION.ELEMENTCODE))=11 AND VARCHAR_FORMAT (ELEMENTSINSPECTION.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
        AND SALES.LONGDESCRIPTION = '$row1[BUYER]' AND SALES.LEGALNAME1='$row1[LANGGANAN]' AND ELEMENTSINSPECTIONEVENT.CODEEVENTCODE = 'P01'
        GROUP BY 
        SALES.LEGALNAME1,
        SALES.LONGDESCRIPTION) A
        ON Z.LEGALNAME1 = A.LANGGANAN AND Z.LONGDESCRIPTION = A.BUYER
        WHERE Z.LONGDESCRIPTION = '$row1[BUYER]' AND Z.LEGALNAME1='$row1[LANGGANAN]'
        GROUP BY 
        Z.LEGALNAME1, Z.LONGDESCRIPTION, A.POINTS_P01";
      $stmt6=db2_exec($conn1,$sqlP, array('cursor'=>DB2_SCROLLABLE));
      $rP = db2_fetch_assoc($stmt6);
      $EPRINT = explode(".",$rP['POINTS_P01']);
      
    //QUERY JUMLAH GRADE A, KG A, YD A
    $sqlGA="SELECT 
        Z.LEGALNAME1 AS LANGGANAN, Z.LONGDESCRIPTION AS BUYER, 
        COUNT(Y.ELEMENTCODE) AS JML_A,
          SUM(Y.LENGTHGROSS) AS JML_YARD_A,
          SUM(Y.WEIGHTNET) AS JML_KG_A
      FROM PRODUCTIONDEMAND X 
      LEFT JOIN ELEMENTSINSPECTION Y
      ON X.CODE = Y.DEMANDCODE
      LEFT JOIN
        (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
          SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
          SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
          FROM SALESORDER SALESORDER
          LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
          LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
          LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
          LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
          LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
          SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
          SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
          SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
          SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
          GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
          SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) Z
      ON X.PROJECTCODE = Z.CODE AND X.ORIGDLVSALORDERLINEORDERLINE = Z.ORDERLINE
      WHERE LENGTH(TRIM(Y.ELEMENTCODE))=11 
      AND VARCHAR_FORMAT (Y.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
      AND Y.QUALITYCODE ='1' AND Z.LONGDESCRIPTION = '$row1[BUYER]' AND Z.LEGALNAME1='$row1[LANGGANAN]'
      GROUP BY 
      Z.LEGALNAME1, Z.LONGDESCRIPTION";
    $stmt7=db2_exec($conn1,$sqlGA, array('cursor'=>DB2_SCROLLABLE));
    $rGA = db2_fetch_assoc($stmt7);

    //QUERY JUMLAH GRADE B, KG B, YD B
    $sqlGB="SELECT 
        Z.LEGALNAME1 AS LANGGANAN, Z.LONGDESCRIPTION AS BUYER, 
        COUNT(Y.ELEMENTCODE) AS JML_B,
          SUM(Y.LENGTHGROSS) AS JML_YARD_B,
          SUM(Y.WEIGHTNET) AS JML_KG_B
      FROM PRODUCTIONDEMAND X 
      LEFT JOIN ELEMENTSINSPECTION Y
      ON X.CODE = Y.DEMANDCODE
      LEFT JOIN
        (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
          SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
          SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
          FROM SALESORDER SALESORDER
          LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
          LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
          LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
          LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
          LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
          SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
          SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
          SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
          SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
          GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
          SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) Z
      ON X.PROJECTCODE = Z.CODE AND X.ORIGDLVSALORDERLINEORDERLINE = Z.ORDERLINE
      WHERE LENGTH(TRIM(Y.ELEMENTCODE))=11 
      AND VARCHAR_FORMAT (Y.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
      AND Y.QUALITYCODE ='2' AND Z.LONGDESCRIPTION = '$row1[BUYER]' AND Z.LEGALNAME1='$row1[LANGGANAN]'
      GROUP BY 
      Z.LEGALNAME1, Z.LONGDESCRIPTION";
    $stmt8=db2_exec($conn1,$sqlGB, array('cursor'=>DB2_SCROLLABLE));
    $rGB = db2_fetch_assoc($stmt8);

    //QUERY JUMLAH GRADE C, KG C, YD C
    $sqlGC="SELECT 
        Z.LEGALNAME1 AS LANGGANAN, Z.LONGDESCRIPTION AS BUYER, 
        COUNT(Y.ELEMENTCODE) AS JML_C,
          SUM(Y.LENGTHGROSS) AS JML_YARD_C,
          SUM(Y.WEIGHTNET) AS JML_KG_C
      FROM PRODUCTIONDEMAND X 
      LEFT JOIN ELEMENTSINSPECTION Y
      ON X.CODE = Y.DEMANDCODE
      LEFT JOIN
        (SELECT SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,
          SALESORDER.EXTERNALREFERENCE AS PO_HEADER,SALESORDERLINE.EXTERNALREFERENCE AS PO_LINE,SALESORDERLINE.INTERNALREFERENCE, 
          SALESORDERLINE.ITEMDESCRIPTION, SALESORDERLINE.ORDERLINE, ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION 
          FROM SALESORDER SALESORDER
          LEFT JOIN SALESORDERLINE SALESORDERLINE ON SALESORDER.CODE = SALESORDERLINE.SALESORDERCODE
          LEFT JOIN ORDERPARTNERBRAND ORDERPARTNERBRAND ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNERBRAND.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDER.ORDERPARTNERBRANDCODE = ORDERPARTNERBRAND.CODE
          LEFT JOIN ORDERPARTNER ORDERPARTNER ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERPARTNER.CUSTOMERSUPPLIERCODE
          LEFT JOIN BUSINESSPARTNER BUSINESSPARTNER ON ORDERPARTNER.ORDERBUSINESSPARTNERNUMBERID = BUSINESSPARTNER.NUMBERID
          LEFT JOIN ORDERITEMORDERPARTNERLINK ORDERITEMORDERPARTNERLINK ON SALESORDER.ORDPRNCUSTOMERSUPPLIERCODE = ORDERITEMORDERPARTNERLINK.ORDPRNCUSTOMERSUPPLIERCODE AND SALESORDERLINE.ITEMTYPEAFICODE= ORDERITEMORDERPARTNERLINK.ITEMTYPEAFICODE AND 
          SALESORDERLINE.SUBCODE01 = ORDERITEMORDERPARTNERLINK.SUBCODE01 AND SALESORDERLINE.SUBCODE02 = ORDERITEMORDERPARTNERLINK.SUBCODE02 AND SALESORDERLINE.SUBCODE03 = ORDERITEMORDERPARTNERLINK.SUBCODE03 AND
          SALESORDERLINE.SUBCODE04 = ORDERITEMORDERPARTNERLINK.SUBCODE04 AND SALESORDERLINE.SUBCODE05 = ORDERITEMORDERPARTNERLINK.SUBCODE05 AND SALESORDERLINE.SUBCODE06 = ORDERITEMORDERPARTNERLINK.SUBCODE06 AND 
          SALESORDERLINE.SUBCODE07 = ORDERITEMORDERPARTNERLINK.SUBCODE07 AND SALESORDERLINE.SUBCODE08 = ORDERITEMORDERPARTNERLINK.SUBCODE08 AND SALESORDERLINE.SUBCODE09 = ORDERITEMORDERPARTNERLINK.SUBCODE09 AND 
          SALESORDERLINE.SUBCODE10 = ORDERITEMORDERPARTNERLINK.SUBCODE10
          GROUP BY SALESORDER.CODE,SALESORDER.ORDERPARTNERBRANDCODE,ORDERPARTNERBRAND.LONGDESCRIPTION,
          SALESORDER.EXTERNALREFERENCE,SALESORDERLINE.EXTERNALREFERENCE,SALESORDERLINE.ITEMDESCRIPTION,BUSINESSPARTNER.LEGALNAME1,SALESORDERLINE.INTERNALREFERENCE, SALESORDERLINE.ORDERLINE,ORDERITEMORDERPARTNERLINK.SHORTDESCRIPTION) Z
      ON X.PROJECTCODE = Z.CODE AND X.ORIGDLVSALORDERLINEORDERLINE = Z.ORDERLINE
      WHERE LENGTH(TRIM(Y.ELEMENTCODE))=11 
      AND VARCHAR_FORMAT (Y.INSPECTIONSTARTDATETIME ,'YYYY-MM-DD') BETWEEN '$Awal' AND '$Akhir'
      AND Y.QUALITYCODE ='3' AND Z.LONGDESCRIPTION = '$row1[BUYER]' AND Z.LEGALNAME1='$row1[LANGGANAN]'
      GROUP BY 
      Z.LEGALNAME1, Z.LONGDESCRIPTION";
    $stmt9=db2_exec($conn1,$sqlGC, array('cursor'=>DB2_SCROLLABLE));
    $rGC = db2_fetch_assoc($stmt9);
		 ?>
          <tr valign="top">
            <td><?php echo number_format(($row1['TOTAL_POIN'] * 100)/$row1['TOTAL_YARD'],2);?></td>
            <td align="center"><font size="-2"><?php echo strtoupper($row1['LANGGANAN']);?></font></td>
            <td align="center"><font size="-2"><?php echo $rr['TOTAL_ROLL'];?></font></td>
            <td align="center"><font size="-2"><?php echo $row1['TOTAL_QTY'];?></font></td>
            <td align="center"><font size="-2"><?php echo $row1['TOTAL_YARD'];?></font></td>
            <td align="center"><?php if($rY['POINTS_Y01']!=''){echo $ASLUB[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rY['POINTS_Y02']!=''){echo $ABARRE[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rY['POINTS_Y03']!=''){echo $AUNEVEN[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rY['POINTS_Y04']!=''){echo $AYARN[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rY['POINTS_Y05']!=''){echo $ANEPS[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rT['POINTS_T01']!=''){echo $BMISSING[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rT['POINTS_T02']!=''){echo $BHOLES[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rT['POINTS_T03']!=''){echo $BSTREAK[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rT['POINTS_T04']!=''){echo $BMISSKNIT[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rT['POINTS_T05']!=''){echo $BKNOT[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rT['POINTS_T06']!=''){echo $BOIL[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rT['POINTS_T07']!=''){echo $BFLY[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rD['POINTS_D01']!=''){echo $CHAIR[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rD['POINTS_D02']!=''){echo $CHOLES[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rD['POINTS_D03']!=''){echo $CCOLOR[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rD['POINTS_D04']!=''){echo $CABRA[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rD['POINTS_D05']!=''){echo $CDYE[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rD['POINTS_D06']!=''){echo $CWRINK[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rD['POINTS_D07']!=''){echo $CBOWING[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rD['POINTS_D08']!=''){echo $CPIN[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rD['POINTS_D09']!=''){echo $CPICK[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rD['POINTS_D10']!=''){echo $CKNOT[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rC['POINTS_C01']!=''){echo $DUNEVEN[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rC['POINTS_C02']!=''){echo $DSTAINS[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rC['POINTS_C03']!=''){echo $DOIL[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rC['POINTS_C04']!=''){echo $DDIRT[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rC['POINTS_C05']!=''){echo $DWATER[0];}else{echo "0";}?></td>
            <td align="center"><?php if($rP['POINTS_P01']!=''){echo $EPRINT[0];}else{echo "0";}?></td>
            <td align="center"><?php echo $totalpoin[0];?></td>
            <td align="center"><?php if($rGA['JML_A']!=''){echo $rGA['JML_A'];}else{echo "0";}?></td>
            <td align="center"><?php if($rGA['JML_KG_A']!=''){echo $rGA['JML_KG_A'];}else{echo "0";}?></td>
            <td align="center"><?php if($rGA['JML_YARD_A']!=''){echo $rGA['JML_YARD_A'];}else{echo "0";}?></td>
            <td align="center"><?php if($rGB['JML_B']!=''){echo $rGB['JML_B'];}else{echo "0";}?></td>
            <td align="center"><?php if($rGB['JML_KG_B']!=''){echo $rGB['JML_KG_B'];}else{echo "0";}?></td>
            <td align="center"><?php if($rGB['JML_YARD_B']!=''){echo $rGB['JML_YARD_B'];}else{echo "0";}?></td>
            <td align="center"><?php if($rGC['JML_C']!=''){echo $rGC['JML_C'];}else{echo "0";}?></td>
            <td align="center"><?php if($rGC['JML_KG_C']!=''){echo $rGC['JML_KG_C'];}else{echo "0";}?></td>
            <td align="center"><?php if($rGC['JML_YARD_C']!=''){echo $rGC['JML_YARD_C'];}else{echo "0";}?></td>
          </tr>
          <?php	} ?>	
        </tbody>
    </tr>
</table>

<script>
//alert('cetak');window.print();
</script> 
</body>
</html>